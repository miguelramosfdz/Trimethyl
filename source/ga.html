<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='GA'>/**
</span> * @class  GA
 * @author  Flavio De Stefano &lt;flavio.destefano@caffeinalab.com&gt;
 * Proxy module for Google Analitycs
 *
 * Require &#39;analitycs.google&#39;
 *
 */

<span id='GA-property-config'>/**
</span> * * **ua**: UA of Google Analitycs. Default: `null`
 * @type {Object}
 */
var config = _.extend({
	ua: null
}, Alloy.CFG.T.ga);
exports.config = config;


var AnalyticsGoogle = require(&#39;analytics.google&#39;);
var tracker = null;

function track(method, what) {
	Ti.API.debug(&#39;GA: track&#39; + method, what);
	tracker[&#39;track&#39;+method](what);
}


<span id='GA-method-trackEvent'>/**
</span> * Track an event
 *
 * @param  {String} cat 	Category **or object passed to native proxy**
 * @param  {String} act 	The action
 * @param  {String} [lbl] 	Label
 * @param  {String} [val]	Value
 */
function trackEvent(cat, act, lbl, val){
	if (tracker === null) return;
	var obj = {};

	if (_.isObject(cat)) {
		obj = cat;
	} else {
		obj.category = cat;
		obj.action = act;
		obj.label = lbl ? lbl : &#39;&#39;;
		obj.value = val ? +val : 0;
	}

	track(&#39;Event&#39;, obj);
}
exports.trackEvent = trackEvent;

<span id='GA-method-event'>/**
</span> * @method event
 * @inheritDoc #trackEvent
 * Alias for {@link #trackEvent}
 */
exports.event = trackEvent;


<span id='GA-method-trackScreen'>/**
</span> * Track a screen
 *
 * @param  {String} name The screen name
 */
function trackScreen(obj){
	if (tracker === null) return;

	track(&#39;Screen&#39;, obj);
}
exports.trackScreen = trackScreen;

<span id='GA-method-screen'>/**
</span> * @method screen
 * @inheritDoc #trackScreen
 * Alias for {@link #trackScreen}
 */
exports.screen = trackScreen;


<span id='GA-method-trackSocial'>/**
</span> * Track a social action
 *
 * @param  {String} net 		The social network name **or object passed to native proxy**
 * @param  {String} [act] 		The action (Default `share`)
 * @param  {String} [tar] 		Target
 */
function trackSocial(net, act, tar){
	if (tracker === null) return;
	var obj = {};

	if (_.isObject(net)) {
		obj = net;
	} else {
		obj.network = net;
		obj.action = act || &#39;share&#39;;
		obj.target = tar || &#39;&#39;;
	}

	track(&#39;Social&#39;, obj);
}
exports.trackSocial = trackSocial;

<span id='GA-method-social'>/**
</span> * @method social
 * @inheritDoc #trackSocial
 * Alias for {@link #trackSocial}
 */
exports.social = trackSocial;



<span id='GA-method-trackTiming'>/**
</span> * Track timing
 *
 * @param  {String} cat 		Category **or object passed to native proxy**
 * @param  {String} time 		Time expressed in ms
 * @param  {String} [name] 	Name
 * @param  {String} [lbl]		Label
 */
function trackTiming(cat, time, name, lbl){
	if (tracker === null) return;
	var obj = {};

	if (_.isObject(cat)) {
		obj = cat;
	} else {
		obj.category = cat;
		obj.time = time;
		obj.name = name || &#39;&#39;;
		obj.label = lbl || &#39;&#39;;
	}

	track(&#39;Timing&#39;, obj);
}
exports.trackTiming = trackTiming;

<span id='GA-method-time'>/**
</span> * @method time
 * @inheritDoc #trackTiming
 * Alias for {@link #trackTiming}
 */
exports.time = trackTiming;



<span id='GA-method-setTrackerUA'>/**
</span> * Set the tracker UA.
 * @param {String} ua
 */
function setTrackerUA(ua) {
	tracker = AnalyticsGoogle.getTracker(ua);
}
exports.setTrackerUA = setTrackerUA;


/*
Init
*/

AnalyticsGoogle.trackUncaughtExceptions = true;
AnalyticsGoogle.debug = false;

if (config.ua) {
	setTrackerUA(config.ua);
}
</pre>
</body>
</html>
